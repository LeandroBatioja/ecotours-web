---
const { lat, lng, zoom = 8 } = Astro.props;
const mapId = `map-${lat}-${lng}`.replaceAll(".", "");
---

<div
  id={mapId}
  class="w-full h-64 rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700"
></div>

<script is:inline>
  (function () {
    if (typeof window === "undefined") return;

    const script = document.createElement("script");
    script.src = "https://unpkg.com/leaflet@1.9.4/dist/leaflet.js";
    script.onload = () => {
      const map = L.map("{mapId}").setView([{lat}, {lng}], {zoom});

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "Â© OpenStreetMap",
      }).addTo(map);

      L.marker([{lat}, {lng}]).addTo(map);
    };

    document.head.appendChild(script);
  })();
</script>

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>
